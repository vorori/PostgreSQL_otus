
# 1)
создайте виртуальную машину c Ubuntu 20.04 LTS (bionic) в GCE/ЯО

# 2)
поставьте на нее PostgreSQL 14 через sudo apt

# 3)
проверьте что кластер запущен через sudo -u postgres pg_lsclusters

# 4)
зайдите из под пользователя postgres в psql и сделайте произвольную таблицу с произвольным содержимым
postgres=# create table test(c1 text);
postgres=# insert into test values('1');

# 5)
остановите postgres например через sudo -u postgres pg_ctlcluster 14 main stop

# 6)
создайте новый standard persistent диск GKE через Compute Engine -> Disks в том же регионе и зоне что GCE инстанс размером например 10GB

# 7)
добавьте свеже-созданный диск к виртуальной машине - надо зайти в режим ее редактирования и дальше выбрать пункт attach existing disk

# 8)
проинициализируйте диск согласно инструкции и подмонтировать файловую систему, только не забывайте менять имя диска на актуальное, 
в вашем случае это скорее всего будет /dev/sdb - https://www.digitalocean.com/community/tutorials/how-to-partition-and-format-storage-devices-in-linux

# 9)
перезагрузите инстанс и убедитесь, что диск остается примонтированным (если не так смотрим в сторону fstab)

# 10)
сделайте пользователя postgres владельцем /mnt/data - chown -R postgres:postgres /mnt/data/

# 11)
перенесите содержимое /var/lib/postgres/14 в /mnt/data - mv /var/lib/postgresql/14 /mnt/data

# 12)
попытайтесь запустить кластер - sudo -u postgres pg_ctlcluster 14 main start

# 13)
напишите получилось или нет и почему

# 14)
задание: найти конфигурационный параметр в файлах раположенных в /etc/postgresql/14/main который надо поменять и поменяйте его

# 15)
напишите что и почему поменяли

# 16)
попытайтесь запустить кластер - sudo -u postgres pg_ctlcluster 14 main start

# 17)
напишите получилось или нет и почему

# 18)
зайдите через через psql и проверьте содержимое ранее созданной таблицы

# 19)
задание со звездочкой *: не удаляя существующий инстанс ВМ сделайте новый, поставьте на его PostgreSQL, 
удалите файлы с данными из /var/lib/postgres, перемонтируйте внешний диск который сделали ранее от первой 
виртуальной машины ко второй и запустите PostgreSQL на второй машине так чтобы он работал с данными на внешнем диске, 
расскажите как вы это сделали и что в итоге получилось.